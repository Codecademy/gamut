import {
  ButtonDeprecated,
  DeprecatedModal,
  Overlay,
} from '@codecademy/gamut/src';
import title from '@codecademy/macros/lib/title.macro';
import { PropsTable } from '@codecademy/storybook-addon-variance';
import { Canvas, Meta, Story } from '@storybook/addon-docs/blocks';
import LinkTo from '@storybook/addon-links/react';
import { useState } from 'react';

<Meta
  title={title}
  component={DeprecatedModal}
  subcomponents={{ Overlay }}
  parameters={{
    subtitle: `Simple DeprecatedModal portal to escape current DOM Context.`,
    status: 'deprecated',
    source: 'gamut',
    figmaId: 'yt7NdZTETDRPUn0CtRu3v0',
  }}
/>

<Canvas>
  <Story name="DeprecatedModal">
    {(args) => {
      const [isOpen, setIsOpen] = useState(false);
      return (
        <>
          <ButtonDeprecated onClick={() => setIsOpen(true)}>
            Open
          </ButtonDeprecated>
          <DeprecatedModal
            isOpen={isOpen}
            onRequestClose={() => setIsOpen(false)}
          >
            Close the DeprecatedModal!
          </DeprecatedModal>
        </>
      );
    }}
  </Story>
</Canvas>

> Prefer <LinkTo kind="Molecules/Dialog" story="Dialog">Dialog</LinkTo> instead.

<PropsTable components={{ DeprecatedModal, Overlay }} />

### Creating a custom close button

By default, the DeprecatedModal will render a close button.

You can disable the default close button with the `hideDefaultCloseButton` prop.

You can then use the `isOpen` prop to create other controls that toggle the DeprecatedModal on and off.

<Canvas>
  <Story name="Without Close Default">
    {(args) => {
      const [isOpen, setIsOpen] = useState(false);
      return (
        <>
          <ButtonDeprecated onClick={() => setIsOpen(true)}>
            Open
          </ButtonDeprecated>
          <DeprecatedModal
            isOpen={isOpen}
            hideDefaultCloseButton
            onRequestClose={() => setIsOpen(false)}
          >
            <p>Close the DeprecatedModal...</p>
            <ButtonDeprecated block onClick={() => setIsOpen(false)}>
              with this button instead
            </ButtonDeprecated>
          </DeprecatedModal>
        </>
      );
    }}
  </Story>
</Canvas>

### Alternative closing methods

Other than creating buttons that can close the DeprecatedModal, there are other ways a DeprecatedModal can be closed by the user.

1. Clicking the content outside of the DeprecatedModal
2. Clicking the escape key on their keyboard

All of these methods default to true for accessibility reasons, and rely on setting the required `onRequestClose` prop and making sure it toggles the `isOpen` prop on the DeprecatedModal.

<Canvas>
  <Story name="Clicking Outside">
    {(args) => {
      const [isOpen, setIsOpen] = useState(false);
      return (
        <>
          <ButtonDeprecated onClick={() => setIsOpen(true)}>
            Open
          </ButtonDeprecated>
          <DeprecatedModal
            isOpen={isOpen}
            hideDefaultCloseButton
            onRequestClose={() => setIsOpen(false)}
          >
            <p>
              Close this DeprecatedModal by clicking the page outside of the
              DeprecatedModal content, or by clicking the escape key.
            </p>
          </DeprecatedModal>
        </>
      );
    }}
  </Story>
</Canvas>
