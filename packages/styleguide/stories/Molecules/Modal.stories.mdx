import { FillButton, Modal, Overlay } from '@codecademy/gamut/src';
import title from '@codecademy/macros/lib/title.macro';
import { PropsTable } from '@codecademy/storybook-addon-variance';
import { Canvas, Meta, Story } from '@storybook/addon-docs/blocks';
import { useState } from 'react';

<Meta
  title={title}
  component={Modal}
  subcomponents={{ Overlay }}
  parameters={{
    subtitle: `Simple Modal portal to escape current DOM Context.`,
    status: 'current',
    source: 'gamut',
  }}
/>

<Canvas>
  <Story name="Modal">
    {(args) => {
      const [isOpen, setIsOpen] = useState(false);
      return (
        <>
          <FillButton onClick={() => setIsOpen(true)}>Open</FillButton>
          <Modal isOpen={isOpen} onRequestClose={() => setIsOpen(false)}>
            Close the Modal!
          </Modal>
        </>
      );
    }}
  </Story>
</Canvas>

<PropsTable components={{ Modal, Overlay }} />

### Creating a custom close button

By default, the Modal will render a close button.

You can disable the default close button with the `hideDefaultCloseButton` prop.

You can then use the `isOpen` prop to create other controls that toggle the Modal on and off.

<Canvas>
  <Story name="Without Close Default">
    {(args) => {
      const [isOpen, setIsOpen] = useState(false);
      return (
        <>
          <FillButton onClick={() => setIsOpen(true)}>Open</FillButton>
          <Modal
            isOpen={isOpen}
            hideDefaultCloseButton
            onRequestClose={() => setIsOpen(false)}
          >
            <p>Close the Modal...</p>
            <FillButton block onClick={() => setIsOpen(false)}>
              with this button instead
            </FillButton>
          </Modal>
        </>
      );
    }}
  </Story>
</Canvas>

### Alternative closing methods

Other than creating buttons that can close the Modal, there are other ways a Modal can be closed by the user.

1. Clicking the content outside of the Modal
2. Clicking the escape key on their keyboard

All of these methods default to true for accessibility reasons, and rely on setting the required `onRequestClose` prop and making sure it toggles the `isOpen` prop on the Modal.

<Canvas>
  <Story name="Clicking Outside">
    {(args) => {
      const [isOpen, setIsOpen] = useState(false);
      return (
        <>
          <FillButton onClick={() => setIsOpen(true)}>Open</FillButton>
          <Modal
            isOpen={isOpen}
            hideDefaultCloseButton
            onRequestClose={() => setIsOpen(false)}
          >
            <p>
              Close this Modal by clicking the page outside of the Modal
              content, or by clicking the escape key.
            </p>
          </Modal>
        </>
      );
    }}
  </Story>
</Canvas>
