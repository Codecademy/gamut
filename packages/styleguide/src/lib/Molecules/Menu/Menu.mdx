import { Canvas, Controls, Meta } from '@storybook/blocks';

import {
  Callout,
  ComponentHeader,
  ImageWrapper,
  LinkTo,
} from '~styleguide/blocks';

import * as MenuStories from './Menu.stories';

export const parameters = {
  title: 'Menu',
  subtitle: `The Menu component with MenuItem and MenuSeparator subcomponents.`,
  design: {
    type: 'figma',
    url: 'https://www.figma.com/file/ReGfRNillGABAj5SlITalN/%F0%9F%93%90-Gamut?node-id=30420-41119&m=dev',
  },
  status: 'current',
  source: {
    repo: 'gamut',
    githubLink:
      'https://github.com/Codecademy/gamut/blob/main/packages/gamut/src/Menu/Menu.tsx',
  },
};

<Meta of={MenuStories} />

<ComponentHeader {...parameters} />

## Usage

Use a Menu to organize and present a list of actions, options, or navigation links.

### Components

- `Menu`: An unordered list that defines the structure and style of its constituents. Menus are nestable and keep track of their configuration and depth through the MenuContext.
- `MenuItem`: A clickable list item that renders as a link or a clickable `li` element if a href is specified.
- `MenuSeparator`: A semantic element for separating `li` items visually. This element will not display if used outside of `action` menus.

### Best practices:

- If a `Menu` is presenting actions or options, you should assign `role="menu"`.
- If the menu only contains a list of navigation links, then wrap a `<nav>` element around the `Menu` component for semantic and accessible navigation — the `nav` element implicitly includes the `navigation` role.
- You can create floating menus by utilizing our <LinkTo id="Atoms/PopoverContainer">PopoverContainer</LinkTo>. Once you have your base positioning, you just need to adjust the y axis by 48 for the normal spacing or 32 for the condensed spacing for each of the MenuItems. You may also need to change the alignment of the PopoverContainer to ensure correct positioning.

### When NOT to use:

- Form Inputs - For selecting from a predefined set of choices within a form, use the SelectDropdown component.
- Expandable Menus - For organizing multiple collapsible sections of navigation links in a structured layout, use the LayoutMenu component.
- Switching between content - For toggling between multiple related views or content sections within the same context, use the Tabs component.

## Anatomy

<ImageWrapper src="./molecules/menuAnatomy.png" alt="Menu Anatomy diagram" />

1. Leading Icon (optional)

- Use to visually reinforce the purpose of a menu item, improve scannability, or differentiate between actions.

2. Label

- Limit to 1-3 words.
- For actions, use a verb that clearly explains what will happen.
- When the menu item is linking to information, use a noun.
- Keep the same word form for each grouping. (For example, all nouns or all verbs.)
- Order and group by meaning or alphabetically.
- Avoid placing words that look the same (for example, that start with the exact same letters) adjacent to one another.

3. Menu separator (optional)

- Use to group menu items into sections when there is a significant number of items, making lengthy menus easier to scan and navigate.

## Variants

In both `popover` and `fixed` variants of `Menu`, you can set the `active` and `disabled` states on the `MenuItem` children. The `active` state indicates the currently selected item, while the `disabled` state indicates that an item is unavailable for interaction. You can optionally use the `label` prop to render a ToolTip explaining why a `MenuItem` is disabled — see the "Icon-Only Menus + ToolTips" section for more details.

<Callout
  text={
    <>
      The <code>Menu</code> component is stateless, you'll need to implement the
      logic to manage the <code>active</code> and <code>disabled</code> states
      of <code>MenuItem</code> components.
    </>
  }
/>

### Popover

Use the Popover menu to present a temporary surface for actions, options, or links, ensuring access only when needed while keeping the interface clean and focused.

<Canvas of={MenuStories.Popover} />

### Fixed

Use the Fixed menu to provide persistent access to navigation links, allowing users to seamlessly move between sections of the interface without opening additional surfaces. Fixed menus should always use the `<nav>` element to ensure semantic and accessible navigation.

<Canvas of={MenuStories.Fixed} />

## Roles

The `Menu` component can be used with different roles depending on its purpose:

- presenting actions or options, you should assign `role="menu"`.
- containing a list of navigation links, then wrap a `<nav>` element around the `Menu` component for semantic and accessible navigation — the `nav` element implicitly includes the `navigation` role.
- if no role is specified and the `Menu` is not wrapped in a `<nav>`, it will render with no role as a `<ul>` and its `MenuItem` children will be `<li>`.

### Menu role

<Canvas of={MenuStories.MenuRole} />

### Navigation

<Canvas of={MenuStories.NavMenu} />

### No role

<Canvas of={MenuStories.NoRoleMenu} />

## Spacing variants

Setting the Menu's `spacing` to `'condensed'` will reduce the padding around the MenuItems.

### Popover condensed

<Canvas of={MenuStories.PopoverCondensed} />

### Fixed condensed

<Canvas of={MenuStories.FixedCondensed} />

## Menu separator

Use the `MenuSeparator` component to group menu items into sections when there is a significant number of items, making lengthy menus easier to scan and navigate.

<Canvas of={MenuStories.PopoverMenuSeparator} />
<Canvas of={MenuStories.FixedMenuSeparator} />

## Icon-Only Menus + ToolTips

Some menus may have only icons, which can be useful for saving space or for actions that are easily recognizable by their icon. Each `MenuItem` must include a `label` prop, which will populate the `ToolTip` if the `MenuItem` is interactive and `aria-label` if not interactive. Non-interactive `MenuItem` components should NOT have a `ToolTip` — instead, use an <LinkTo id="Molecules/Tips/InfoTip">InfoTip</LinkTo> to provide more context.

If you need fine-tuned control of the `ToolTip`, you can pass a config object to the `label` prop based off of our `ToolTip` props. Notice in the example below, aside from the first option, the rest of the options use the `alignment` prop to set the `ToolTip` to the right of their respective icon.

<Canvas of={MenuStories.IconMenu} />

## Floating menus

You can create floating menus by utilizing our <LinkTo id="Atoms/PopoverContainer">PopoverContainer</LinkTo>. Once you have your base positioning, you just need to adjust the y axis by 48 for the normal spacing or 32 for the condensed spacing for each of the MenuItems. You may also need to change the alignment of the PopoverContainer to ensure correct positioning.

Floating menus that have complex functionalities or actions, like the example below, should have the menu role.

Click through each item to see how the `Menu`s appear (and disappear when the item is clicked again, or another item is selected.)

<Canvas of={MenuStories.FloatingMenuExample} />

## Playground

<Canvas sourceState="shown" of={MenuStories.Default} />

<Controls />
