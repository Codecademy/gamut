import { Canvas, Controls, Meta } from '@storybook/blocks';

import { ComponentHeader, LinkTo } from '~styleguide/blocks';

import * as ConnectedFormGroupStories from './ConnectedFormGroup.stories';

export const parameters = {
  title: 'ConnectedFormGroup',
  subtitle: `A form group for the ConnectedForm component.`,
  status: 'updating',
  source: {
    repo: 'gamut',
    githubLink:
      'https://github.com/Codecademy/gamut/blob/main/packages/gamut/src/ConnectedForm/ConnectedFormGroup.tsx',
  },
};

<Meta of={ConnectedFormGroupStories} />

<ComponentHeader {...parameters} />

## Usage

`ConnectedFormGroup` is a <LinkTo id='Atoms/FormElements/FormGroup'>FormGroup</LinkTo> that uses the context provided by `ConnectedForm` for error and disabled states. This component ensures that every field has proper error handling and accessibility. It also will type its `field` to the proper `ConnectedFormInput` passed into `component`.

`ConnectedFormGroup` should primarly be used with the `useConnectedForm` hook. Below is an example, notice that the `options` prop should have elements in its array that contain both a `label` and `value` property:

```tsx
<ConnectedFormGroup
  name="badRadioGroup"
  label="cool radio group dude"
  field={{
    component: ConnectedRadioGroupInput,
    // Type error, these options are not formatted correctly.
    options: ['one', 'two', 'zero'],
  }}
/>

<ConnectedFormGroup
  name="goodRadioGroup"
  label="cool radio group dude"
  field={{
    component: ConnectedRadioGroupInput,
    // Perfection ðŸ™Œ
    options: [
      { label: 'one', value: 'one' },
      { label: 'two', value: 'two' },
      { label: 'zero', value: 'zero' },
    ],
  }}
/>
```

## States

A `ConnectedFormGroup` can be in one of three states: `default`, `error`, or `disabled`.

- `default` being a standard group that can be interacted with.
- `error` being a group that has an error message displayed.
- `disabled` being a group that is disabled and therefore not interactable.

<Canvas of={ConnectedFormGroupStories.States} />

## InfoTip

A `ConnectedFormGroup` can include an `infotip` prop to provide additional context.

### Automatic labelling

InfoTip buttons are automatically labelled by string field labels for accessibility.

<Canvas of={ConnectedFormGroupStories.InfoTipAutoLabelling} />

### ReactNode labels

For ReactNode labels (e.g., styled text or icons), the InfoTip is automatically labelled by the field label. You can override this behavior by providing:

- `ariaLabel` - provide a custom accessible name
- `ariaLabelledby` - reference another element on the page, such as a section heading

<Canvas of={ConnectedFormGroupStories.InfoTipWithReactNodeLabel} />

## Playground

To see how a `ConnectedFormGroup` can be used in a `ConnectedForm`, check out the <LinkTo id="Organisms/ConnectedForm/ConnectedForm">ConnectedForm</LinkTo> page.

<Canvas sourceState="shown" of={ConnectedFormGroupStories.Default} />

<Controls />
