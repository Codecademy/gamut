"use strict";(self.webpackChunkgamut_repo=self.webpackChunkgamut_repo||[]).push([[8169],{"./node_modules/media-captions/dist/prod/ssa-parser.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{SSAParser:()=>SSAParser,default:()=>createSSAParser});var _index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/media-captions/dist/prod/index.js");const FORMAT_START_RE=/^Format:[\s\t]*/,STYLE_START_RE=/^Style:[\s\t]*/,DIALOGUE_START_RE=/^Dialogue:[\s\t]*/,FORMAT_SPLIT_RE=/[\s\t]*,[\s\t]*/,STYLE_FUNCTION_RE=/\{[^}]+\}/g,NEW_LINE_RE=/\\N/g,STYLES_SECTION_START_RE=/^\[(.*)[\s\t]?Styles\]$/,EVENTS_SECTION_START_RE=/^\[(.*)[\s\t]?Events\]$/;class SSAParser{h;O=0;c=null;l=[];m=[];N=null;f;P={};async init(init){this.h=init,init.errors&&(this.f=(await __webpack_require__.e(5457).then(__webpack_require__.bind(__webpack_require__,"./node_modules/media-captions/dist/prod/errors.js"))).ParseErrorBuilder)}parse(line,lineCount){if(this.O)switch(this.O){case 1:if(""===line)this.O=0;else if(STYLE_START_RE.test(line))if(this.N){const styles=line.replace(STYLE_START_RE,"").split(FORMAT_SPLIT_RE);this.S(styles)}else this.g(this.f?.T("Style",lineCount));else FORMAT_START_RE.test(line)?this.N=line.replace(FORMAT_START_RE,"").split(FORMAT_SPLIT_RE):EVENTS_SECTION_START_RE.test(line)&&(this.N=null,this.O=2);break;case 2:if(""===line)this.Q();else if(DIALOGUE_START_RE.test(line))if(this.Q(),this.N){const dialogue=line.replace(DIALOGUE_START_RE,"").split(FORMAT_SPLIT_RE),cue=this.U(dialogue,lineCount);cue&&(this.c=cue)}else this.g(this.f?.T("Dialogue",lineCount));else this.c?this.c.text+="\n"+line.replace(STYLE_FUNCTION_RE,"").replace(NEW_LINE_RE,"\n"):FORMAT_START_RE.test(line)?this.N=line.replace(FORMAT_START_RE,"").split(FORMAT_SPLIT_RE):STYLES_SECTION_START_RE.test(line)?(this.N=null,this.O=1):EVENTS_SECTION_START_RE.test(line)&&(this.N=null)}else""===line||(STYLES_SECTION_START_RE.test(line)?(this.N=null,this.O=1):EVENTS_SECTION_START_RE.test(line)&&(this.N=null,this.O=2))}done(){return{metadata:{},cues:this.l,regions:[],errors:this.m}}Q(){this.c&&(this.l.push(this.c),this.h.onCue?.(this.c),this.c=null)}S(values){let outlineX,marginV,outlineColor,bgColor,name="Default",styles={},align="center",vertical="bottom",outlineY=1.2,borderStyle=3,transform=[];for(let i=0;i<this.N.length;i++){const field=this.N[i],value=values[i];switch(field){case"Name":name=value;break;case"Fontname":styles["font-family"]=value;break;case"Fontsize":styles["font-size"]=`calc(${value} / var(--overlay-height))`;break;case"PrimaryColour":const color=parseColor(value);color&&(styles["--cue-color"]=color);break;case"BorderStyle":borderStyle=parseInt(value,10);break;case"BackColour":bgColor=parseColor(value);break;case"OutlineColour":const _outlineColor=parseColor(value);_outlineColor&&(outlineColor=_outlineColor);break;case"Bold":parseInt(value)&&(styles["font-weight"]="bold");break;case"Italic":parseInt(value)&&(styles["font-style"]="italic");break;case"Underline":parseInt(value)&&(styles["text-decoration"]="underline");break;case"StrikeOut":parseInt(value)&&(styles["text-decoration"]="line-through");break;case"Spacing":styles["letter-spacing"]=value+"px";break;case"AlphaLevel":styles.opacity=parseFloat(value);break;case"ScaleX":transform.push(`scaleX(${parseFloat(value)/100})`);break;case"ScaleY":transform.push(`scaleY(${parseFloat(value)/100})`);break;case"Angle":transform.push(`rotate(${value}deg)`);break;case"Shadow":outlineY=1.2*parseInt(value,10);break;case"MarginL":styles["--cue-width"]="auto",styles["--cue-left"]=parseFloat(value)+"px";break;case"MarginR":styles["--cue-width"]="auto",styles["--cue-right"]=parseFloat(value)+"px";break;case"MarginV":marginV=parseFloat(value);break;case"Outline":outlineX=parseInt(value,10);break;case"Alignment":const alignment=parseInt(value,10);switch(alignment>=4&&(vertical=alignment>=7?"top":"center"),alignment%3){case 1:align="start";break;case 2:align="center";break;case 3:align="end"}}}if(styles.R=vertical,styles["--cue-white-space"]="normal",styles["--cue-line-height"]="normal",styles["--cue-text-align"]=align,"center"===vertical?(styles["--cue-top"]="50%",transform.push("translateY(-50%)")):styles[`--cue-${vertical}`]=(marginV||0)+"px",1===borderStyle&&(styles["--cue-padding-y"]="0"),(1===borderStyle||bgColor)&&(styles["--cue-bg-color"]=1===borderStyle?"none":bgColor),3===borderStyle&&outlineColor&&(styles["--cue-outline"]=`${outlineX}px solid ${outlineColor}`),1===borderStyle&&"number"==typeof outlineX){const color=bgColor??"#000";styles["--cue-text-shadow"]=[outlineColor&&buildTextShadow(1.2*outlineX,1.2*outlineY,outlineColor),outlineColor?buildTextShadow(outlineX*(outlineX/2),outlineY*(outlineX/2),color):buildTextShadow(outlineX,outlineY,color)].filter(Boolean).join(", ")}transform.length&&(styles["--cue-transform"]=transform.join(" ")),this.P[name]=styles}U(values,lineCount){const fields=this.V(values),timestamp=this.q(fields.Start,fields.End,lineCount);if(!timestamp)return;const cue=new _index_js__WEBPACK_IMPORTED_MODULE_0__.b(timestamp[0],timestamp[1],""),styles={...this.P[fields.Style]||{}},voice=fields.Name?`<v ${fields.Name}>`:"",vertical=styles.R,marginLeft=fields.MarginL&&parseFloat(fields.MarginL),marginRight=fields.MarginR&&parseFloat(fields.MarginR),marginV=fields.MarginV&&parseFloat(fields.MarginV);return marginLeft&&(styles["--cue-width"]="auto",styles["--cue-left"]=marginLeft+"px"),marginRight&&(styles["--cue-width"]="auto",styles["--cue-right"]=marginRight+"px"),marginV&&"center"!==vertical&&(styles[`--cue-${vertical}`]=marginV+"px"),cue.text=voice+values.slice(this.N.length-1).join(", ").replace(STYLE_FUNCTION_RE,"").replace(NEW_LINE_RE,"\n"),delete styles.R,Object.keys(styles).length&&(cue.style=styles),cue}V(values){const fields={};for(let i=0;i<this.N.length;i++)fields[this.N[i]]=values[i];return fields}q(startTimeText,endTimeText,lineCount){const startTime=(0,_index_js__WEBPACK_IMPORTED_MODULE_0__.p)(startTimeText),endTime=(0,_index_js__WEBPACK_IMPORTED_MODULE_0__.p)(endTimeText);if(null!==startTime&&null!==endTime&&endTime>startTime)return[startTime,endTime];null===startTime&&this.g(this.f?.s(startTimeText,lineCount)),null===endTime&&this.g(this.f?.t(endTimeText,lineCount)),null!=startTime&&null!==endTime&&endTime>startTime&&this.g(this.f?.u(startTime,endTime,lineCount))}g(error){if(error){if(this.m.push(error),this.h.strict)throw this.h.cancel(),error;this.h.onError?.(error)}}}function parseColor(color){const abgr=parseInt(color.replace("&H",""),16);if(abgr>=0){return"rgba("+[255&abgr,abgr>>8&255,abgr>>16&255,(abgr>>24&255^255)/255].join(",")+")"}return null}function buildTextShadow(x,y,color){const noOfShadows=Math.ceil(2*Math.PI*x);let textShadow="";for(let i=0;i<noOfShadows;i++){const theta=2*Math.PI*i/noOfShadows;textShadow+=x*Math.cos(theta)+"px "+y*Math.sin(theta)+"px 0 "+color+(i==noOfShadows-1?"":",")}return textShadow}function createSSAParser(){return new SSAParser}}}]);